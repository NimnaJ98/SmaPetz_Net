{% extends 'base.html' %}
{% load static %}

{% block extrahead %}
    <link rel="stylesheet" href={% static 'profiles/profile.css' %}>
    <script src={% static 'profiles/profile.js' %} defer></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
{% endblock extrahead %}

{% block title %} 
    pet profile
{% endblock title %}

{% block content %}

<!-- Button trigger modal -->
{% if confirm %}
<div class="alert alert-success alert-dismissible fade show" role="alert">
    Your Profile has been Updated
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
</div>
{% endif %}

<div class="card-lg">
  <div class="card-body">
    <div class = "row profileRow">
      <div class="col-sm-4">
        <img class="img-fluid m-3" alt="Responsive image" src={{profile.profilePic.url}}>
      </div>
      <div class="col-sm-4">
          <div class="username mt-3">
            {{request.user.name}}
            <!-- Update profile button -->
            <button type="button" class="btn btnUpdate" data-toggle="modal" data-target="#exampleModal">
              <i class="fa fa-paw"></i>
              Update Profile
            </button>
          </div>
          <div class ="titles mt-4">
            <a href="#" class="badge">{{profile.get_post_no}} Posts</a>
            <a href="#" class="badge">{{profile.get_following_no}} Following</a>
            <a href="#" class="badge">{{profile.get_followers_count}} Followers</a>
          </div>
          <div class ="userDetail mt-4">
            {{profile.bio}} <br>
            {{profile.breed}}
          </div>
      </div>
    </div>
  </div>
   {% comment %} <div class="card-body "> {% endcomment %}
      <ul class="nav nav-tabs justify-content-center">
        <li class="tab active mr-4"><a data-toggle="tab" href="#gallery">Gallery</a></li>
        <li class="tab"><li><a data-toggle="tab" href="#videos">Videos</a></li>
        <li class="tab mr-4"><li><a data-toggle="tab" href="#posts">Posts</a></li>
      </ul>
        <div class="tab-content">
          <div id="gallery" class="tab-pane active">
            <div class="card-group">
              {% for obj in photo %}
                {% if request.user == obj.author.user %}
                  <div class="card-gallery m-2 mt-3" style="width: 18rem !important; height: 20rem !important;">
                    <img src={{obj.picture.url}} class="card-img-top" alt="...">
                    <div class="card-body">
                      <h6 class="card-title">{{obj.caption}}</h6> 
                      <p class="card-text"><small class="text-muted">{{obj.tags}}</small></p>
                    </div>
                  </div>
                {% endif %}
              {% endfor %}
            </div>
          </div>
          <div id="videos" class="tab-pane fade">
            <div class="card-group">
              {% for obj in video %}
                {% if request.user == obj.author.user %}
                  <div class="card-gallery m-2 mt-3" style="width: 18rem !important; height: 20rem !important;">
                    <video controls autoplay muted id="vid">
                      <source src={{obj.video.url}} type="video/mp4"></source>
                    </video>
                    <div class="card-body">
                      <h6 class="card-title">{{obj.caption}}</h6> 
                      <p class="card-text"><small class="text-muted">{{obj.tags}}</small></p>
                    </div>
                  </div>
                {% endif %}
              {% endfor %}
            </div>
          </div>
          <div id="posts" class="tab-pane fade">
            <div class="card-group">
              {% for obj in post %}
                {% if request.user == obj.author.user %}
                  {% if obj not in photo and video %}
                    <div class="card-gallery m-2 mt-3" style="width: 18rem !important; height: 20rem !important;">
                      <div class="card-body">
                        <h6 class="card-title">{{obj.caption}}</h6> 
                        <p class="card-text"><small class="text-muted">{{obj.tags}}</small></p>
                      </div>
                    </div>
                  {% endif %}
                {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>
    {% comment %} </div> {% endcomment %}
  </div>

  <!-- Update modal -->  
  <div class="modal fade update" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">

        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Update Your Profile</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form action="" method="POST" class="form-group" enctype ="multipart/form-data">
            {% csrf_token %}
            <div class="container mb-1">
              <div class="row">
                <div class="col">
                  <div class ="image content ml-3"><img src = {{profile.profilePic.url}}></div><br>
                  <div class ="description ml-3">{{pet_form.profilePic}}</div>
                </div>
                <div class="col mb-1">
                  <div class ="description mb-2">Bio : {{pet_form.bio}}</div>
                  <div class ="description mb-2">Address : {{pet_form.address}}</div>
                  <div class ="description">Telephone Number : {{pet_form.number}}</div>
                  <div class ="description mt-3" id='chooseType'>Pet Type : {{pet_form.pet_type}}</div><br>
                  <div class ="description">Breed : {{pet_form.breed}}</div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btnModal" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btnModal">Save changes</button>
            </div>
          </form>
        </div>  
      </div>
    </div>
  </div>  
</div>


{% endblock content %}